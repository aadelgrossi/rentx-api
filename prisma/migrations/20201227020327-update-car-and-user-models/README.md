# Migration `20201227020327-update-car-and-user-models`

This migration has been generated by Andre Grossi at 12/26/2020, 11:03:27 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."FuelType" AS ENUM ('gas', 'electric', 'hybrid')

CREATE TYPE "public"."Transmission" AS ENUM ('auto', 'manual')

ALTER TABLE "Car" DROP CONSTRAINT "Car_brandId_fkey"

ALTER TABLE "Car" DROP COLUMN "model",
DROP COLUMN "brandId",
ADD COLUMN     "name" TEXT NOT NULL,
ADD COLUMN     "manufacturerId" TEXT NOT NULL,
ADD COLUMN     "photoId" TEXT NOT NULL,
ADD COLUMN     "fuelType" "FuelType" NOT NULL,
ADD COLUMN     "transmission" "Transmission" NOT NULL

ALTER TABLE "User" DROP COLUMN "firstName",
DROP COLUMN "lastName",
ADD COLUMN     "name" TEXT NOT NULL

CREATE TABLE "CarManufacturer" (
    "id" TEXT NOT NULL,
    "name" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "Photo" (
    "id" TEXT NOT NULL,
    "url" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

DROP TABLE "CarBrand"

CREATE UNIQUE INDEX "CarManufacturer.name_unique" ON "CarManufacturer"("name")

ALTER TABLE "Car" ADD FOREIGN KEY("manufacturerId")REFERENCES "CarManufacturer"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Car" ADD FOREIGN KEY("photoId")REFERENCES "Photo"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201114003825-change-daily-rate-to-int..20201227020327-update-car-and-user-models
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -12,25 +12,44 @@
 model User {
   id        String   @id @default(cuid())
   email     String   @unique
-  firstName String
-  lastName  String
+  name      String
   password  String
   admin Boolean @default(false)
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
 }
-model CarBrand {
+enum FuelType {
+  gas
+  electric
+  hybrid
+}
+
+enum Transmission {
+  auto
+  manual
+}
+
+model CarManufacturer {
   id        String @id @default(cuid())
   name      String @unique
 }
+model Photo {
+  id        String @id @default(cuid())
+  url       String
+}
+
 model Car {
-  id         String @id @default(cuid())
-  model      String
-  brandId    String
-  brand      CarBrand @relation(fields: [brandId], references: [id])
-  year       Int
-  dailyRate  Int
+  id                String @id @default(cuid())
+  name              String
+  manufacturerId    String
+  manufacturer      CarManufacturer @relation(fields: [manufacturerId], references: [id])
+  year              Int
+  dailyRate         Int
+  photoId           String
+  photo             Photo @relation(fields: [photoId], references: [id])
+  fuelType          FuelType
+  transmission      Transmission
 }
```


